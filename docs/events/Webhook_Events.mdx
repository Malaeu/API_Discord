---
sidebar_label: Webhook Events
---

# Webhook Events

Webhook events are one-way events sent to your app over HTTP to notify you when an event occured. Unlike events that are [sent over Gateway connections](#DOCS_EVENTS_GATEWAY), events sent over webhooks are not realtime or guaranteed to be in order.

While [outgoing webhooks](#DOCS_RESOURCES_WEBHOOK) are triggered by an external service, webhook events (i.e. incoming webhooks) are triggered by events happening in Discord. This means your app will need to set up a public URL where you can receive HTTP events, which is detailed in the [preparing for events](#DOCS_EVENTS_WEBHOOK_EVENTS/preparing-for-events) section.

## Subscribing to Events

To configure webhook events, you'll need to configure your URL and select the events you want your app to receive.

In your [app's settings](https://discord.com/developers/applications), navigate to the **Webhooks** page from the left-hand sidebar then complete the following:

1. Under **Endpoint**, add a public URL that is set up to receive and acknowledge webhook events. Details about setting up a Webhook Events URL is in the [preparing for events](#DOCS_EVENTS_WEBHOOK_EVENTS/preparing-for-events) section.
2. Enable Events by clicking the toggle in the **Events** section
3. Select the [webhook events](#DOCS_EVENTS_WEBHOOK_EVENTS/event-types) you want your app to receive
4. Click **Save Changes**

If your URL is successfully verified, your app should begin receiving the events you selected.

## Preparing for Events

To receive webhook events, you'll need to configure your app's **Webhook Event URL** in your app's settings.

### Configuring a Webhook Events URL

A **Webhook Events URL** is a public endpoint for your app where Discord can send your app HTTP-based events. If your app is using [Gateway events](#DOCS_EVENTS_GATEWAY), you don't need to configure a Webhook Events URL.

#### Setting Up an Endpoint

Before you can add a Webhook Events URL to your app, your endpoint must be prepared for two things ahead of time:

1. Acknowledging `"PING"` events from Discord
2. Validate security-related request headers (`X-Signature-Ed25519` and `X-Signature-Timestamp`)

If either of these are not complete, your Webhook Events URL will not be validated. Details on acknowledging PING events and validating security-related headers are below.

###### Acknowledging PING requests

When adding your Webhook Events URL, Discord will send a `POST` request with a `PING` payload with a `type: "PING"` to your endpoint. Your app is expected to acknowledge the request by returning a `200` response with a `PONG` payload (which has `type: 1`).

<Collapsible title="Responding to PING Requests" description="Code example for acknowledging PING events" icon="code">
To properly acknowledge a `PING` payload, return a `200` response with a payload of `type: 1`:

```py
@app.route('/', methods=['POST'])
def my_command():
    if request.json["type"] == 'PING':
        return jsonify({
            "type": 1
        })
```
</Collapsible> 

###### Validating Security Request Headers

The internet is a scary place, especially for people hosting public, unauthenticated endpoints. To receive events via HTTP, there are some security steps you **must** take before your app is eligible to receive requests.

Each interaction is sent with the following headers:

-   `X-Signature-Ed25519` as a signature
-   `X-Signature-Timestamp` as a timestamp

Using your favorite security library, you **must validate the request each time you receive an event**. If the signature fails validation, your app should respond with a `401` error code.

<Collapsible title="Validating Security Headers" description="Code example for validating security-related request headers" icon="code">
Below are some code examples that show how to validate the headers sent in event requests.

**JavaScript**

```js
const nacl = require("tweetnacl");

// Your public key can be found on your application in the Developer Portal
const PUBLIC_KEY = "APPLICATION_PUBLIC_KEY";

const signature = req.get("X-Signature-Ed25519");
const timestamp = req.get("X-Signature-Timestamp");
const body = req.rawBody; // rawBody is expected to be a string, not raw bytes

const isVerified = nacl.sign.detached.verify(
    Buffer.from(timestamp + body),
    Buffer.from(signature, "hex"),
    Buffer.from(PUBLIC_KEY, "hex")
);

if (!isVerified) {
    return res.status(401).end("invalid request signature");
}
```

**Python**

```py
from nacl.signing import VerifyKey
from nacl.exceptions import BadSignatureError

# Your public key can be found on your application in the Developer Portal
PUBLIC_KEY = 'APPLICATION_PUBLIC_KEY'

verify_key = VerifyKey(bytes.fromhex(PUBLIC_KEY))

signature = request.headers["X-Signature-Ed25519"]
timestamp = request.headers["X-Signature-Timestamp"]
body = request.data.decode("utf-8")

try:
    verify_key.verify(f'{timestamp}{body}'.encode(), bytes.fromhex(signature))
except BadSignatureError:
    abort(401, 'invalid request signature')
```
</Collapsible> 

In addition to ensuring your app validates security-related request headers at the time of saving your endpoint, Discord will also perform automated, routine security checks against your endpoint, including purposefully sending you invalid signatures. If you fail the validation, we will remove your Webhook Events URL and alert you via email and System DM.

We recommend checking out our [Community Resources](#DOCS_DEVELOPER_TOOLS_COMMUNITY_RESOURCES/interactions) and the libraries found there.

#### Adding an Webhook Events Endpoint URL

After you have a public endpoint to use as your app's Event Webhooks URL, you can add it to your app by going to your [app's settings](https://discord.com/developers/applications).

On the **Webhooks** page, look for the **Endpoint URL** field. Paste your public URL that is set up to acknowledge `PING` messages and correctly handles security-related signature headers.

After you configure your Webhook Events URL, you can [enable and subscribe to events](#DOCS_EVENTS_WEBHOOK_EVENTS/subscribing-to-events) on the same page.


## Responding to Events

When your Webhook Event URL receives a webhook event, your app should respond with a `200` (Success) status code **within 3 seconds** to indicate that you successfully received it.

If your app doesn't respond to the webhook event, Discord will retry sending it several times using exponential backoff for up to 10 minutes. TODO: verify

If your app doesn't acknowledge that it received events, Discord will consider your endpoint inactive and eventually stop sending new events. TODO: verify

## Webhook Event Payloads

Webhook events are wrapped in an outer payload, with an inner `event` object.

### Payload Structure

Structure of the outer webhook payload

| Field          | Type                                                               | Description                                                                             |
|----------------|--------------------------------------------------------------------|-----------------------------------------------------------------------------------------|
| version        | integer                                                            | Version scheme for the webhook event. Currently always `1`                              |
| application_id | snowflake                                                          | ID of your app                                                                          |
| type           | string                                                             | [Webhook type](#DOCS_EVENTS_WEBHOOK_EVENTS/webhook-types), either `"EVENT"` or `"PING"` |
| event?         | [event body](#DOCS_EVENTS_WEBHOOK_EVENTS/event-body-object) object | Event data payload                                                                      |

#### Webhook Types

| Type  | Value     | Description                                                                                             |
|-------|-----------|---------------------------------------------------------------------------------------------------------|
| PING  | `"PING"`  | PING event sent to verify your Webhook Event URL is active                                              |
| Event | `"EVENT"` | Webhook event (details for event in [event body](#DOCS_EVENTS_WEBHOOK_EVENTS/event-body-object) object) |

#### Event Body Object

The event body contains high-level data about the event, like the type and time it was triggered.

The inner `data` object contains information specific to the [event type](#DOCS_EVENTS_WEBHOOK_EVENTS/event-types).

| Field     | Type   | Description                                                                                        |
|-----------|--------|----------------------------------------------------------------------------------------------------|
| type      | string | [Event type](#DOCS_EVENTS_WEBHOOK_EVENTS/event-types)                                              |
| timestamp | string | Timestamp of when the event occurred in [ISO8601 format](#DOCS_REFERENCE/iso8601-datetime)         |
| data?     | object | Data for the event. The shape depends on the [event type](#DOCS_EVENTS_WEBHOOK_EVENTS/event-types) |


## Event Types

The table below includes the different webhook event types your app can subscribe to.

The event type corresponds to the `type` field in the [event body object](#DOCS_EVENTS_WEBHOOK_EVENTS/event-body-object).

| Name                                                                         | Type                     | Description                                                                 |
|------------------------------------------------------------------------------|--------------------------|-----------------------------------------------------------------------------|
| [Application Authorized](#DOCS_EVENTS_WEBHOOK_EVENTS/application-authorized) | `APPLICATION_AUTHORIZED` | Sent when an app was authorized by a user to a server or their user account |
| [Entitlement Create](#DOCS_EVENTS_WEBHOOK_EVENTS/entitlement-create)         | `ENTITLEMENT_CREATE`     | Entitlement was created                                                     |
| [Quest User Enrollment](#DOCS_EVENTS_WEBHOOK_EVENTS/quest-user-enrollment)   | `QUEST_USER_ENROLLMENT`  | User was added to a Quest (currently unavailable)                           |

#### Application Authorized

`APPLICATION_AUTHORIZED` is sent when the app is added to a server or user account.

###### Application Authorized Structure

| Field             | Type                                                               | Description                                                                                                                                                                                                             |
|-------------------|--------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| integration_type? | integer                                                            | [Installation context](#DDOCS_RESOURCES_APPLICATION/application-object-application-integration-types) for the authorization. Either guild (`0`) if installed to a server or user (`1`) if installed to a user's account |
| user              | [user object](#DOCS_RESOURCES_USER/user-object-user-structure)     | User who authorized the app                                                                                                                                                                                             |
| scopes            | array of strings                                                   | List of [scopes](#DOCS_TOPICS_OAUTH2/shared-resources-oauth2-scopes) the user authorized                                                                                                                                |
| guild?            | [guild object](#DOCS_RESOURCES_GUILD/guild-object-guild-structure) | Server which app was authorized for (when integration type is `0`)                                                                                                                                                      |


###### Application Authorized Example

```json
{
  "version": 1,
  "application_id": "1234560123453231555",
  "type": "EVENT",
  "event": {
    "type": "APPLICATION_AUTHORIZED",
    "timestamp": "2024-10-18T14:42:53.064834",
    "data": {
      "integration_type": 1,
      "scopes": [
        "applications.commands"
      ],
      "user": {
        // user data
      }
    }
  }
}
```

#### Entitlement Create

`ENTITLEMENT_CREATE` is sent when an [entitlement](#DOCS_RESOURCES_ENTITLEMENT) is created when a user purchases or is otherwise granted one of your app's SKUs. Refer to the [Monetization documentation](#DOCS_MONETIZATION_OVERVIEW) for details.

###### Entitlement Create Structure

The inner payload is an [entitlement](#DOCS_RESOURCES_ENTITLEMENT/entitlement-object) object.

###### Entitlement Create Example

```json
TODO
```

#### Quest User Enrollment

> warn
> This event cannot be receive by apps at this time. It's documented because it appears on the Webhooks settings page.

`QUEST_USER_ENROLLMENT` is sent when a user is added to a Quest on Discord.
